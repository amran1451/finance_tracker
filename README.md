# FinVault – Offline-first Finance Tracker

FinVault — это персональное офлайн-приложение для учёта финансов, построенное на Flutter и Riverpod. Оно использует локальную базу данных SQLite (drift) с сид-данными, поддерживает планы, периоды зарплат, аналитику и резервные копии.

## Возможности
- Онбординг с выбором типа зарплатного периода и базовой валюты.
- Домашний экран с метрикой Safe-to-Spend, балансами счетов и карточками ближайших планов.
- Быстрый ввод транзакций с кастомной клавиатурой, поддержкой плановых/неплановых трат и чеков.
- Планировщик с приоритетами, переносом задач и визуализацией прогресса.
- Полная лента транзакций с фильтрами и Inbox для неразобранных операций.
- Аналитика (план/факт, тепловая карта, тренды) и экспорт CSV/PDF (PDF — заглушка).
- Бюджеты с переносом остатков, подписки, цели, календарь и управление счетами.
- Правила автокатегоризации, резервное копирование .finvault с шифрованием, импорт/экспорт CSV.
- Локализации RU/EN и темы Material 3 (light/dark).

## Структура проекта
Основные директории расположены по спецификации:
```
lib/
  core/…
  data/…
  features/…
  services/…
  l10n/
assets/
  icons/
  images/
test/
  unit/
  widget/
```

## Сборка и запуск
1. Установите Flutter 3.x.
2. Установите зависимости и выполните генерацию кода:
   ```bash
   flutter pub get
   dart run build_runner build --delete-conflicting-outputs
   ```
3. Запустите приложение:
   ```bash
   flutter run
   ```

Для сборки релиза используйте `flutter build apk`.

## База данных и резервное копирование
- Файл базы данных создаётся в каталоге документов приложения: `finvault.sqlite`.
- Шифрованная резервная копия сохраняется в том же каталоге с расширением `.finvault`.
- Экспорт CSV формируется в каталоге документов (`finvault_export.csv`).
- Импорт CSV доступен из настроек (используется `file_picker`).

## Сид-данные
При первом запуске выполняется сидирование:
- 2 счёта (наличные, карта), основные категории, теги.
- Два зарплатных периода (предыдущий и текущий).
- 10+ транзакций, планы, подписки и цель «Подушка».

Чтобы пересоздать БД с сид-данными, удалите файл `finvault.sqlite` и перезапустите приложение.

## Карта экранов
- Нижняя навигация: Дом, План, + (быстрый ввод), Транзакции, Аналитика.
- Боковое меню: Бюджет, Подписки, Цели, Календарь, Счета, Поиск, Настройки.

Для макетов используются карточки с мягкими тенями и цветовой кодировкой: план — синий, факт — фиолетовый, неплан — янтарный.

## Тесты
Запуск unit- и widget-тестов:
```bash
flutter test
```

В комплект входят:
- Unit: движок правил, отчёты периода, перенос планов, расчёт переносов бюджета и др.
- Widget: smoke-тесты экранов Быстрого ввода, Планов, Аналитики.
- Golden: карточка плана.

## Импорт/экспорт и бэкапы
- Экспорт CSV и создание резервной копии доступны из экрана «Настройки».
- Резервная копия шифруется ключом, который хранится в `flutter_secure_storage` и выводится через PBKDF2-подобный алгоритм.
- Импорт CSV — stub с разбором заголовков и подготовкой к маппингу.

## Ограничения
- OCR и интеграции реализованы как заглушки.
- PDF отчёт генерируется примитивно (stub) и может требовать дальнейшей доработки.

## Скриншоты
Плейсхолдер для скриншотов приложения находится в директории `assets/images/`.
